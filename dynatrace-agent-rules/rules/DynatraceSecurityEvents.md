# Dynatrace Security Events Reference

Security events are a special type of data representing various events generated by Dynatrace. In the events data store, security events are stored in a dedicated bucket (default_security_events) and come as an additional event kind (`event.kind=="SECURITY_EVENT"`) for better access control, data separation, and data retention period control.

## Event Types Overview

### 1. Compliance Events

- **COMPLIANCE_FINDING** - Individual compliance evaluation results
- **COMPLIANCE_SCAN_COMPLETED** - Scan completion notifications

### 2. Vulnerability Events

- **VULNERABILITY_STATUS_CHANGE_EVENT** - Status changes at entity/vulnerability level
- **VULNERABILITY_ASSESSMENT_CHANGE_EVENT** - Assessment changes at entity/vulnerability level
- **VULNERABILITY_STATE_REPORT_EVENT** - Historical state reports at entity/vulnerability level
- **VULNERABILITY_FINDING** - Generic vulnerability findings with extensions

---

## Compliance Finding Events

A compliance finding event is generated when an object is evaluated against a compliance rule during a scan. The event contains the results of this evaluation and the compliance status of the given object.

### Event Data

| Attribute  | Type      | Description                                                                                                                                                                                                 | Examples            |
| ---------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------- |
| event.kind | string    | Gives high-level information about what kind of information the event contains without being specific about the contents of the event. It helps to determine the record type of a raw event.Tags:permission | SECURITY_EVENT      |
| event.type | string    | The unique type identifier of a given event.Tags:permission                                                                                                                                                 | COMPLIANCE_FINDING  |
| timestamp  | timestamp | The time (UNIX Epoch time in nanoseconds) when the event was ingested.                                                                                                                                      | 1649822520123123123 |

### Finding Data

| Attribute                             | Type      | Description                                                                                                                           | Examples                                     |
| ------------------------------------- | --------- | ------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------- |
| aws.account.id                        | string    | The 12-digit number, such as 123456789012, that uniquely identifies an AWS account.Tags:permissionprimary-field                       | 123456789012                                 |
| aws.account.name                      | string    | Name associated with the AWS account.                                                                                                 | example.com                                  |
| azure.tenant.id                       | string    | Unique, immutable identifier assigned to the Azure tenant.                                                                            | 37c4add3-612a-483d-8b24-cccbb35d3306         |
| azure.tenant.name                     | string    | Name assigned to the Azure tenant.                                                                                                    | MyAzureTenant                                |
| cloud.provider                        | string    | Name of the cloud provider.                                                                                                           | alibaba_cloud                                |
| dt.entity.cloud_application           | string    | An entity ID of an entity of type CLOUD_APPLICATION.Tags:entity-id                                                                    | CLOUD_APPLICATION-3AB5BBF3E09A7942           |
| dt.entity.cloud_application_instance  | string    | An entity ID of an entity of type CLOUD_APPLICATION_INSTANCE.Tags:entity-id                                                           | CLOUD_APPLICATION_INSTANCE-E0D8F94D9065F24F  |
| dt.entity.cloud_application_namespace | string    | An entity ID of an entity of type CLOUD_APPLICATION_NAMESPACE. A CLOUD_APPLICATION_NAMESPACE is a Kubernetes namespace.Tags:entity-id | CLOUD_APPLICATION_NAMESPACE-C61324AA70F57BCB |
| dt.entity.kubernetes_cluster          | string    | An entity ID of an entity of type KUBERNETES_CLUSTER.Tags:entity-id                                                                   | KUBERNETES_CLUSTER-E0D8F94D9065F24F          |
| dt.entity.kubernetes_node             | string    | An entity ID of an entity of type KUBERNETES_NODE.Tags:entity-id                                                                      | KUBERNETES_NODE-874C66B68CE15070             |
| finding.id                            | string    | Unique identifier string of a finding.                                                                                                | F-2GJ3LSUM                                   |
| finding.time.created                  | timestamp | Time when the finding was created.                                                                                                    | 2024-06-24T04:47:21.154000000+02:00          |
| gcp.organization.id                   | string    | Unique, immutable identifier assigned to an organization resource.                                                                    | 123456789012                                 |
| gcp.organization.name                 | string    | Name assigned to the GCP organization.                                                                                                | dynatrace.com                                |
| hypervisor.type                       | string    | Virtualization hypervisor identified. For physical machines, this value is empty.                                                     | KVM;VMWARE                                   |
| k8s.cluster.name                      | string    | (Optional) The user-defined name of the cluster in Dynatrace. Doesn't need to be unique or immutable.Tags:permissionprimary-field     | unguard-dev;acme-prod10                      |
| k8s.cluster.uid                       | string    | A pseudo-ID for the cluster, by default set to the UID of the kube-system namespace.                                                  | 1c7a24c7-ff51-46e0-bcc9-c52637ceec57         |
| k8s.namespace.name                    | string    | The name of the namespace that the pod is running in.Tags:permissionprimary-field                                                     | default;kube-system                          |
| k8s.namespace.uid                     | string    | The UID of the namespace.                                                                                                             | bfb1ba44-3bcb-467d-a2dc-188fd74d1db5         |
| k8s.node.name                         | string    | Name of the node.                                                                                                                     | cluster-pool-1-c3c7423d-azth                 |
| k8s.pod.name                          | string    | The name of the pod.                                                                                                                  | checkoutservice-7895755b94-mzs5m             |
| k8s.pod.uid                           | string    | The UID of the pod.                                                                                                                   | 275ecb36-5aa8-4c2a-9c47-d8bb681b9aff         |
| k8s.workload.name                     | string    | The name of the workload.                                                                                                             | checkoutservice                              |
| k8s.workload.uid                      | string    | The UID of the workload.                                                                                                              | 786a41e4-e673-44bb-bb30-18888f797a2b         |
| vmware.vcenter.name                   | string    | Name of the VMware vCenter server managing the multi-hypervisor environment.                                                          | my-vcenter.lab.dynatrace.org                 |

### Scan Data

| Attribute    | Type   | Description                    | Examples                             |
| ------------ | ------ | ------------------------------ | ------------------------------------ |
| product.name | string | Product name.                  | Tenable;Snyk                         |
| scan.id      | string | Unique identifier of the scan. | 00000000-0000-0000-0000-000000000000 |

### Rule Data

| Attribute                      | Type   | Description                                                                                                                        | Examples                                                                                                                                                            |
| ------------------------------ | ------ | ---------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| compliance.rule.id             | string | Unique identifier of a compliance rule.                                                                                            | CIS-66577                                                                                                                                                           |
| compliance.rule.metadata_json  | string | Any additional metadata associated with the compliance rule.                                                                       | {\"Section\":\"Kubernetes - v1.9.0\",\"Recommendation ID\":\"1.2.16\",\"Recommendation section\":\"1.2 - Control Plane Components - API Server\", \"Level\":\"L1\"} |
| compliance.rule.severity.level | string | Original severity of a compliance rule reported by the vendor.                                                                     | CRITICAL;HIGH;MEDIUM;LOW                                                                                                                                            |
| compliance.rule.severity.score | double | Number assigned to the respective severity. For example, 10 corresponds to 'CRITICAL', 7 to 'HIGH', 4 to 'MEDIUM', and 1 to 'LOW'. | 10.0;7.0;4.0;1.0                                                                                                                                                    |
| compliance.rule.title          | string | Short description of a compliance rule.                                                                                            | The Kubernetes Controller Manager must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination                  |
| compliance.standard.short_name | string | Short name of a compliance standard.                                                                                               | DISA STIG;NIST                                                                                                                                                      |
| compliance.standard.url        | string | Link to the official documentation source about the compliance standard.                                                           | DISA STIG;NIST                                                                                                                                                      |

### Result Data

| Attribute                              | Type   | Description                                                                                                                                             | Examples                                                                                                                                                                            |
| -------------------------------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| aws.resource.name                      | string | Name of the resource (value of the "Name" tag in AWS).                                                                                                  | my-ec2-instance                                                                                                                                                                     |
| azure.resource.id                      | string | A unique, immutable identifier assigned to each Azure cloud resource.                                                                                   | /subscriptions/27e9b03f-04d2-2b69-b327-32f433f7ed21/resourceGroups/demo-backend-rg/providers/Microsoft.ContainerService/managedClusters/demo-aks                                    |
| azure.resource.name                    | string | User-provided name of the Azure cloud resource.                                                                                                         | demo-aks                                                                                                                                                                            |
| compliance.result.description          | string | Details about the compliance result status.                                                                                                             | Object not matching standard inclusion criteria                                                                                                                                     |
| compliance.result.object.evidence_json | string | Reasoning or evidence for the compliance status of this object.                                                                                         | [{"type":"AUTOMATIC","description":"Controller Manager version","value":"1.28.0"},{"type":"AUTOMATIC","description":"Property tls-min-version status","value":"Not set"}]           |
| compliance.result.object.name          | string | Name of the object evaluated for compliance.                                                                                                            | kube-controller-manager-k8s-mst01-t12;daemonset-25qlv                                                                                                                               |
| compliance.result.object.type          | string | Type of the object evaluated for compliance.                                                                                                            | k8scluster;k8spod;k8sservice                                                                                                                                                        |
| compliance.result.status.level         | string | Result status of the given resource object as evaluated by a scan.                                                                                      | FAILED;PASSED;MANUAL;NOT_RELEVANT                                                                                                                                                   |
| compliance.result.status.score         | double | Number assigned to the respective result status. For example, 10 corresponds to 'FAILED', 7 to 'MANUAL', 4 to 'PASSED', and 1 to 'NOT_RELEVANT'.        | 10.0;7.0;4.0;1.0                                                                                                                                                                    |
| dt.source_entity                       | string | The ID of the entity considered the source of the signal. The string represents an entity ID of an entity that is stored in the classic entity storage. | HOST-E0D8F94D9065F24F;PROCESS_GROUP_INSTANCE-E0D8F94D9065F24F                                                                                                                       |
| object.id                              | string | Identifier of the affected object.                                                                                                                      | HOST-E0D8F94D9065F24F;i-06becf87d5326157a;arn:aws:ecr:eu-central-1:124567890123:repository/unguard-frontend/sha256:054e1d39fb20a52f2c78caeb83574035462d3d2e627978d89a2834ce8cb69fe1 |
| object.name                            | string | Name of the affected object.                                                                                                                            | kube-controller-manager-k8s-mst01-t12;daemonset-25qlv                                                                                                                               |
| object.type                            | string | Type of the affected object.                                                                                                                            | HOST;EC2_INSTANCE;CONTAINER_IMAGE                                                                                                                                                   |

---

## Compliance Scan Completed Events

A compliance scan completed event is generated when a scan of a configuration dataset against compliance rules is completed.

### Event Metadata

| Attribute  | Type      | Description                                                                                                                                                                                                 | Examples                  |
| ---------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------- |
| event.kind | string    | Gives high-level information about what kind of information the event contains without being specific about the contents of the event. It helps to determine the record type of a raw event.Tags:permission | SECURITY_EVENT            |
| event.type | string    | The unique type identifier of a given event.Tags:permission                                                                                                                                                 | COMPLIANCE_SCAN_COMPLETED |
| timestamp  | timestamp | The time (UNIX Epoch time in nanoseconds) when the event was ingested.                                                                                                                                      | 1649822520123123123       |

### Scan Info

| Attribute                    | Type      | Description                                                                                                     | Examples                                                                                                                                                                            |
| ---------------------------- | --------- | --------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| aws.account.id               | string    | The 12-digit number, such as 123456789012, that uniquely identifies an AWS account.Tags:permissionprimary-field | 123456789012                                                                                                                                                                        |
| aws.account.name             | string    | Name associated with the AWS account.                                                                           | example.com                                                                                                                                                                         |
| azure.tenant.id              | string    | Unique, immutable identifier assigned to the Azure tenant.                                                      | 37c4add3-612a-483d-8b24-cccbb35d3306                                                                                                                                                |
| azure.tenant.name            | string    | Name assigned to the Azure tenant.                                                                              | MyAzureTenant                                                                                                                                                                       |
| cloud.provider               | string    | Name of the cloud provider.                                                                                     | alibaba_cloud                                                                                                                                                                       |
| dt.entity.kubernetes_cluster | string    | An entity ID of an entity of type KUBERNETES_CLUSTER.Tags:entity-id                                             | KUBERNETES_CLUSTER-E0D8F94D9065F24F                                                                                                                                                 |
| gcp.organization.id          | string    | Unique, immutable identifier assigned to an organization resource.                                              | 123456789012                                                                                                                                                                        |
| gcp.organization.name        | string    | Name assigned to the GCP organization.                                                                          | dynatrace.com                                                                                                                                                                       |
| hypervisor.type              | string    | Virtualization hypervisor identified. For physical machines, this value is empty.                               | KVM;VMWARE                                                                                                                                                                          |
| object.id                    | string    | Identifier of the affected object.                                                                              | HOST-E0D8F94D9065F24F;i-06becf87d5326157a;arn:aws:ecr:eu-central-1:124567890123:repository/unguard-frontend/sha256:054e1d39fb20a52f2c78caeb83574035462d3d2e627978d89a2834ce8cb69fe1 |
| object.name                  | string    | Name of the affected object.                                                                                    | kube-controller-manager-k8s-mst01-t12;daemonset-25qlv                                                                                                                               |
| object.type                  | string    | Type of the affected object.                                                                                    | HOST;EC2_INSTANCE;CONTAINER_IMAGE                                                                                                                                                   |
| product.name                 | string    | Product name.                                                                                                   | Tenable;Snyk                                                                                                                                                                        |
| product.vendor               | string    | Product vendor.                                                                                                 | Tenable;Snyk                                                                                                                                                                        |
| product.version              | string    | Version of the product that performed the scan.                                                                 | 6.9.2.0                                                                                                                                                                             |
| scan.id                      | string    | Unique identifier of the scan.                                                                                  | 00000000-0000-0000-0000-000000000000                                                                                                                                                |
| scan.result.summary_json     | string    | Summary of the scan results.                                                                                    | {"standardResultSummaries":[{"profileCode":"CIS","compliancePercentage":85}]}                                                                                                       |
| scan.time.completed          | timestamp | Time when the scan was completed.                                                                               | 2024-06-24T04:47:21.154000000+02:00                                                                                                                                                 |
| vmware.vcenter.name          | string    | Name of the VMware vCenter server managing the multi-hypervisor environment.                                    | my-vcenter.lab.dynatrace.org                                                                                                                                                        |

---

## Entity Change Events

Entity change events are change events at the entity level. An event is generated whenever a vulnerability's affected entity undergoes a status or assessment change.

### Query Examples

```dql
# Query entity status change events
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_STATUS_CHANGE_EVENT"
| filter event.level == "ENTITY"

# Query entity assessment change events
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_ASSESSMENT_CHANGE_EVENT"
| filter event.level == "ENTITY"
```

### Event Data

| Attribute               | Type      | Description                                                                                                                                                                                                                                                              | Examples                                                                                                                                                                                                                                                 |
| ----------------------- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| event.category          | string    | Categorization based on the product and data generating this event.                                                                                                                                                                                                      | VULNERABILITY_MANAGEMENT                                                                                                                                                                                                                                 |
| event.change_list       | array     | List of attributes updated as part of the change event. Values in the list match a previous field.                                                                                                                                                                       | vulnerability.risk.score;affected_entities.count;related_entities.databases.count                                                                                                                                                                        |
| event.description       | string    | Human-readable description of an event.                                                                                                                                                                                                                                  | Status of S-49 Remote Code Execution for prod_process_group_1 has changed to OPEN.;Assessment of S-49 Remote Code Execution for prod_process_group_1 has changed.;Environment impact of S-49 Remote Code Execution for prod_process_group_1 has changed. |
| event.group_label       | string    | Group label of an event.                                                                                                                                                                                                                                                 | CHANGE_EVENT                                                                                                                                                                                                                                             |
| event.kind              | string    | Gives high-level information about what kind of information the event contains without being specific about the contents of the event. It helps to determine the record type of a raw event.Tags:permission                                                              | SECURITY_EVENT                                                                                                                                                                                                                                           |
| event.level             | string    | Main reference point to which the event or data is related. Possible values are Vulnerability (shows the global aggregation across the entire environment and comprises all entities and management zones) and Entity (shows the assessment based on the entity itself). | ENTITY                                                                                                                                                                                                                                                   |
| event.name              | string    | The human readable display name of an event type.                                                                                                                                                                                                                        | Vulnerable entity status change event;Vulnerable entity assessment change event                                                                                                                                                                          |
| event.provider          | string    | Source of the event, for example, the name of the component or system that generated the event.Tags:permission                                                                                                                                                           | Dynatrace                                                                                                                                                                                                                                                |
| event.provider_product  | string    | Name of the product providing this event.                                                                                                                                                                                                                                | Runtime Vulnerability Analytics;Snyk Container                                                                                                                                                                                                           |
| event.status            | string    | Status of an event as being either Active or Closed.                                                                                                                                                                                                                     | OPEN;RESOLVED;MUTED                                                                                                                                                                                                                                      |
| event.status_transition | string    | An enum that shows the transition of the above event state.                                                                                                                                                                                                              | NEW_OPEN;REOPEN;CLOSE;MUTE;UNMUTE                                                                                                                                                                                                                        |
| event.trigger.type      | string    | Type of event trigger (for example, whether it was generated by the system, ingested via API, or triggered by the user).                                                                                                                                                 | DT_PLATFORM;USER_ACTION                                                                                                                                                                                                                                  |
| event.trigger.user      | string    | ID of the user who triggered the event. If generated by Dynatrace, the value is SYSTEM.                                                                                                                                                                                  | SYSTEM;                                                                                                                                                                                                                                                  |
| event.type              | string    | The unique type identifier of a given event.Tags:permission                                                                                                                                                                                                              | VULNERABILITY_STATUS_CHANGE_EVENT;VULNERABILITY_ASSESSMENT_CHANGE_EVENT                                                                                                                                                                                  |
| timestamp               | timestamp | The time (UNIX Epoch time in nanoseconds) when the event originated, typically when it was created by the source.                                                                                                                                                        | 1649822520123123123                                                                                                                                                                                                                                      |

### Vulnerability Data (Entity Level)

| Attribute                                                 | Type      | Description                                                                                                           | Examples                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| --------------------------------------------------------- | --------- | --------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| entry_points.entry_point_jsons                            | string[]  | JSON representation of entry points of a vulnerability.                                                               | [{ "entry_point.url.path": "/user/2/bio", "entry_point.payload": "UPDATE bio SET bio_text = '' WHERE 1 = 0; TRUNCATE TABLE bio; --' WHERE user_id = 2", "entry_point.user_controlled_inputs_json": [{ "user_controlled_input.type": "HTTP_PARAMETER_VALUE", "user_controlled_input.key": "username", "user_controlled_input.value": "' OR 100=100 -- 0'", "user_controlled_input.payload.start": "56", "user_controlled_input.payload.end": "73", "user_controlled_input.is_malicious": true}]}] |
| vulnerability.code_location.name                          | string    | Name of the code location where the code-level vulnerability was detected.                                            | org.dynatrace.profileservice.BioController.markdownToHtml(String):80                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vulnerability.cvss.base_score                             | double    | Vulnerability's CVSS base score provided by NVD.                                                                      | 8.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vulnerability.cvss.vector                                 | string    | Vulnerability's CVSS vector defined by the provider.                                                                  | CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:L/VA:L/SC:L/SI:L/SA:L;CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:H/E:P/RL:T/RC:U/CR:L/IR:M/AR:H                                                                                                                                                                                                                                                                                                                                                        |
| vulnerability.cvss.version                                | string    | Vulnerability's CVSS score version.                                                                                   | 3.1;4.0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vulnerability.davis_assessment.assessment_mode            | string    | Availability of the information based on which the assessment of the vulnerability at the entity level has been done. | FULL;NOT_AVAILABLE;REDUCED                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vulnerability.davis_assessment.assessment_mode_reasons    | string[]  | Reasons for the assessment mode at the entity level.                                                                  | [LIMITED_BY_CONFIGURATION, LIMITED_AGENT_SUPPORT]                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| vulnerability.davis_assessment.data_assets_status         | string    | Affected entity's reachability by a database.                                                                         | NOT_AVAILABLE;NOT_DETECTED;REACHABLE                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vulnerability.davis_assessment.exploit_status             | string    | Public exploits status of the vulnerability at the entity level.                                                      | AVAILABLE;NOT_AVAILABLE                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vulnerability.davis_assessment.exposure_status            | string    | Internet exposure status of the vulnerability at the entity level.                                                    | NOT_AVAILABLE;NOT_DETECTED;PUBLIC_NETWORK;ADJACENT_NETWORK                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vulnerability.davis_assessment.level                      | string    | Risk level, based on Davis Security Score, of the vulnerability at the entity level.                                  | LOW;MEDIUM;HIGH;CRITICAL;NONE                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| vulnerability.davis_assessment.score                      | double    | Davis Security Score (1-10) calculated by Dynatrace for the vulnerability at the entity level.                        | 8.1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vulnerability.davis_assessment.vulnerable_function_status | string    | Usage status of the vulnerable functions causing the vulnerability at the entity level.                               | IN_USE;NOT_AVAILABLE;NOT_IN_USE                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| vulnerability.description                                 | string    | Description of the vulnerability.                                                                                     | More detailed description about improper input validation vulnerability.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vulnerability.display_id                                  | string    | Dynatrace user-readable identifier for the vulnerability.                                                             | S-1234                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| vulnerability.external_id                                 | string    | External provider's unique identifier for the vulnerability.                                                          | SNYK-JAVA-ORGAPACHEHTTPCOMPONENTS-30646                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vulnerability.external_url                                | string    | External provider's URL to the details page of the vulnerability.                                                     | https://example.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vulnerability.first_seen                                  | timestamp | Timestamp of when the vulnerability at the entity level was first detected.                                           | 2023-03-22T13:19:36.945Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vulnerability.id                                          | string    | Dynatrace unique identifier for the vulnerability.                                                                    | 2039861408676243188                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| vulnerability.is_fix_available                            | boolean   | Indicates if a vulnerability fix is available.                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| vulnerability.mute.change_date                            | timestamp | Timestamp of the last muted or unmuted action of the vulnerability at the entity level.                               | 2023-03-22T13:19:36.945Z                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| vulnerability.mute.comment                                | string    | Comment for muting or unmuting the vulnerability at entity level.                                                     | Muted because it's a false positive.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vulnerability.mute.reason                                 | string    | Reason for muting or unmuting the vulnerability at the entity level.                                                  | FALSE_POSITIVE;IGNORE;AFFECTED;CONFIGURATION_NOT_AFFECTED;OTHER                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| vulnerability.mute.status                                 | string    | Mute status of the vulnerability at the entity level.                                                                 | MUTED;NOT_MUTED                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| vulnerability.mute.user                                   | string    | User who last changed the mute status of the vulnerability at the entity level.                                       | user@example.com                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |

### Environmental Data

#### Affected Entity

| Attribute                                          | Type   | Description                                                                                         | Examples                                                                                                                                               |
| -------------------------------------------------- | ------ | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| affected_entity.affected_processes.ids             | array  | IDs of the processes that are currently affected by the vulnerability.                              | PROCESS_GROUP_INSTANCE-1                                                                                                                               |
| affected_entity.affected_processes.names           | array  | Names of the processes that are currently affected by the vulnerability.                            | prod_process_group_instance_1                                                                                                                          |
| affected_entity.id                                 | string | ID of the affected entity.                                                                          | PROCESS_GROUP-1;HOST-1                                                                                                                                 |
| affected_entity.management_zones.ids               | array  | IDs of the management zones to which the affected entity belongs.                                   | mzid1                                                                                                                                                  |
| affected_entity.management_zones.names             | array  | Names of the management zones to which the affected entity belongs.                                 | mz1                                                                                                                                                    |
| affected_entity.name                               | string | Name of the affected entity.                                                                        | prod_process_group_1;prod_host                                                                                                                         |
| affected_entity.reachable_data_assets.count        | long   | Number of reachable data assets.                                                                    | 1                                                                                                                                                      |
| affected_entity.reachable_data_assets.ids          | array  | IDs of the data assets that can be reached by the affected entities of the vulnerability.           | DATABASE-1                                                                                                                                             |
| affected_entity.reachable_data_assets.names        | array  | Names of the data assets that can be reached by the affected entities of the vulnerability.         | prod_database_1                                                                                                                                        |
| affected_entity.type                               | string | Type of affected entity.                                                                            | PROCESS_GROUP;HOST;KUBERNETES_NODE                                                                                                                     |
| affected_entity.vulnerable_component.id            | string | ID of the vulnerable component causing the vulnerability.                                           | SOFTWARE_COMPONENT-D8FCFFB4FDF7A3FF                                                                                                                    |
| affected_entity.vulnerable_component.name          | string | Name of the vulnerable component causing the vulnerability.                                         | log4j-core-2.6.2.jar                                                                                                                                   |
| affected_entity.vulnerable_component.package_name  | string | Package name of the vulnerable component causing the vulnerability.                                 | k8s.io/kubernetes;github.com/kubernetes/kubernetes/pkg/kubelet/kuberuntime                                                                             |
| affected_entity.vulnerable_component.short_name    | string | Short name of the vulnerable component causing the vulnerability.                                   | log4j                                                                                                                                                  |
| affected_entity.vulnerable_functions               | array  | Vulnerable functions detected, containing or causing the vulnerability.                             | org.springframework.beans.CachedIntrospectionResults:init;java.lang.ProcessBuilder.(String[]);(\*DB).queryDC() (/usr/local/go/src/database/sql/sql.go) |
| affected_entity.vulnerable_functions_not_available | array  | Vulnerable functions detected which Dynatrace can't tell if they're in use due to limited insights. | org.springframework.beans.CachedIntrospectionResults:init;java.lang.ProcessBuilder.(String[]);(\*DB).queryDC() (/usr/local/go/src/database/sql/sql.go) |
| affected_entity.vulnerable_functions_not_in_use    | array  | Vulnerable functions detected which are not actively used.                                          | org.springframework.beans.CachedIntrospectionResults:init;java.lang.ProcessBuilder.(String[]);(\*DB).queryDC() (/usr/local/go/src/database/sql/sql.go) |

#### Related Entities

| Attribute                                   | Type  | Description                                                                       | Examples              |
| ------------------------------------------- | ----- | --------------------------------------------------------------------------------- | --------------------- |
| related_entities.applications.count         | long  | Number of related applications.                                                   | 1                     |
| related_entities.applications.ids           | array | IDs of the applications related to the vulnerability's affected entities.         | APPLICATION-1         |
| related_entities.databases.count            | long  | Number of related databases.                                                      | 1                     |
| related_entities.databases.ids              | array | IDs of the databases related to the vulnerability's affected entities.            | DATABASE-1            |
| related_entities.hosts.count                | long  | Number of related hosts.                                                          | 1                     |
| related_entities.hosts.ids                  | array | IDs of the hosts related to the vulnerability's affected entities.                | HOST-1                |
| related_entities.kubernetes_clusters.count  | long  | Number of related Kubernetes clusters.                                            | 1                     |
| related_entities.kubernetes_clusters.ids    | array | IDs of the Kubernetes clusters related to the vulnerability's affected entities.  | KUBERNETES_CLUSTER-1  |
| related_entities.kubernetes_workloads.count | long  | Number of related Kubernetes workloads.                                           | 1                     |
| related_entities.kubernetes_workloads.ids   | array | IDs of the Kubernetes workloads related to the vulnerability's affected entities. | KUBERNETES_WORKLOAD-1 |
| related_entities.services.count             | long  | Number of related services.                                                       | 1                     |
| related_entities.services.ids               | array | IDs of the services related to the vulnerability's affected entities.             | SERVICE-1             |

---

## Entity State Events

Entity state events are historical vulnerability states reported at the entity level. The current vulnerability state per entity is exported to Grail regularly.

### Query Example

```dql
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_STATE_REPORT_EVENT"
| filter event.level == "ENTITY"
```

---

## Vulnerability Change Events

Vulnerability change events are change events at the vulnerability level. An event is generated whenever a vulnerability undergoes a status or assessment change.

### Query Examples

```dql
# Query vulnerability status change events
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_STATUS_CHANGE_EVENT"

# Query vulnerability assessment change events
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_ASSESSMENT_CHANGE_EVENT"
```

---

## Vulnerability Finding Events

Vulnerability-finding events contain generic sections and fields like metadata, affected entity data and vulnerability data. They can also include extensions (such as container image data for container vulnerability findings).

### Metadata

| Attribute              | Type      | Description                                                                                                                                                                                                 | Examples                                                                                                                         |
| ---------------------- | --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- |
| event.category         | string    | Standard categorization based on the significance of an event (similar to the severity level in the previous Dynatrace).                                                                                    | VULNERABILITY_MANAGEMENT                                                                                                         |
| event.description      | string    | Human-readable description of an event.                                                                                                                                                                     | Vulnerability CVE-2023-45871 of component linux:4.19.269-1 was detected in your container image unguard-frontend:latest@054e1d39 |
| event.id               | string    | Unique identifier string of an event; is stable across multiple refreshes and updates.                                                                                                                      | 5547782627070661074_1647601320000                                                                                                |
| event.kind             | string    | Gives high-level information about what kind of information the event contains without being specific about the contents of the event. It helps to determine the record type of a raw event.Tags:permission | SECURITY_EVENT                                                                                                                   |
| event.name             | string    | The human readable display name of an event type.                                                                                                                                                           | Vulnerability finding event                                                                                                      |
| event.original_content | string    | The original raw data of the event as received from the source.                                                                                                                                             | {"severity_id": 3,"state_id": 1,"time": "2024-06-26T07:15:06.139000Z","state": "New","type_uid": 200101}                         |
| event.provider         | string    | Source of the event, for example, the name of the component or system that generated the event.Tags:permission                                                                                              | Amazon ECR                                                                                                                       |
| event.type             | string    | The unique type identifier of a given event.Tags:permission                                                                                                                                                 | VULNERABILITY_FINDING                                                                                                            |
| event.version          | string    | Describes the version of the event.                                                                                                                                                                         | 1.309                                                                                                                            |
| timestamp              | timestamp | Time (UNIX Epoch time in nanoseconds) when the event originated, typically when the event was ingested into Dynatrace.                                                                                      | 1649822520123123123                                                                                                              |

### Vulnerability Data

| Attribute                             | Type     | Description                                                 | Examples                                                                 |
| ------------------------------------- | -------- | ----------------------------------------------------------- | ------------------------------------------------------------------------ |
| dt.security.risk.level                | string   | Risk score level defined by the provider.                   | LOW;MEDIUM;HIGH;CRITICAL;NONE;NOT_AVAILABLE                              |
| dt.security.risk.score                | double   | Risk score, mapped and normalized by Dynatrace.             | 8.1                                                                      |
| vulnerability.description             | string   | Description of the vulnerability.                           | More detailed description about improper input validation vulnerability. |
| vulnerability.exploit.status          | string   | Whether there is a known exploit for the vulnerability.     | AVAILABLE;NOT_AVAILABLE                                                  |
| vulnerability.id                      | string   | Dynatrace unique identifier for the vulnerability.          | CVE-2019-19814                                                           |
| vulnerability.references.cve          | string[] | List of the vulnerability's CVE IDs.                        | [CVE-2021-41079]                                                         |
| vulnerability.remediation.description | string   | Description of the vulnerability's remediation advice.      | Upgrade to JQuery version 3.5.0 or later.                                |
| vulnerability.remediation.status      | string   | Indicates whether a fix for the vulnerability is available. | AVAILABLE;NOT_AVAILABLE                                                  |
| vulnerability.title                   | string   | Title of the vulnerability.                                 | CVE-2019-19814;Improper input validation                                 |

### Product Data

| Attribute      | Type   | Description     | Examples     |
| -------------- | ------ | --------------- | ------------ |
| product.name   | string | Product name.   | Tenable;Snyk |
| product.vendor | string | Product vendor. | Tenable;Snyk |

### Scan Data

| Attribute           | Type      | Description                       | Examples                             |
| ------------------- | --------- | --------------------------------- | ------------------------------------ |
| scan.id             | string    | Unique identifier of the scan.    | 00000000-0000-0000-0000-000000000000 |
| scan.name           | string    | Name of the scan.                 | US Cloud Scanner                     |
| scan.time.completed | timestamp | Time when the scan was completed. | 2024-06-24T04:47:21.154000000+02:00  |
| scan.time.started   | timestamp | Time when the scan was started.   | 2024-06-24T04:47:21.154000000+02:00  |

### Extensions - Container Image Data

| Attribute                  | Type   | Description                                                                               | Examples                                                                |
| -------------------------- | ------ | ----------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| container_image.digest     | string | Container image digest uniquely and immutably identifying the vulnerable container image. | sha256:054e1d39fb20a52f2c78caeb83574035462d3d2e627978d89a2834ce8cb69fe1 |
| container_image.registry   | string | Container image registry from which the finding originates.                               | 1294385647.eu-central-1                                                 |
| container_image.repository | string | Container image repository from which the finding originates.                             | unguard-frontend                                                        |
| container_image.tags       | array  | List of tags of the vulnerable container image.                                           | [1.0.0];[1.0.0, 1.0.0-nightly, latest]                                  |

---

## Vulnerability State Events

Vulnerability state events are historical states at the vulnerability level. The current vulnerability state is exported to Grail regularly.

### Query Example

```dql
fetch events
| filter event.kind == "SECURITY_EVENT"
| filter event.category == "VULNERABILITY_MANAGEMENT"
| filter event.type == "VULNERABILITY_STATE_REPORT_EVENT"
| filter event.level == "VULNERABILITY"
```

---

## Data Relationships and Connections

### Key Relationship Fields

1. **scan.id** - Links COMPLIANCE_SCAN_COMPLETED events to COMPLIANCE_FINDING events
2. **vulnerability.id** - Links vulnerability events across different types
3. **affected_entity.id** - Links entities to vulnerabilities
4. **dt.entity.\*** - Links to Dynatrace entity model
5. **object.id** - Links compliance findings to specific objects

### Event Flow Patterns

#### Compliance Scanning Flow

1. **COMPLIANCE_SCAN_COMPLETED** event generated with unique `scan.id`
2. Multiple **COMPLIANCE_FINDING** events generated with matching `scan.id`
3. Each finding contains `compliance.result.object.evidence_json` with detailed evidence

#### Vulnerability Management Flow

1. **VULNERABILITY_FINDING** events detect new vulnerabilities
2. **VULNERABILITY_STATE_REPORT_EVENT** events track current state
3. **VULNERABILITY_STATUS_CHANGE_EVENT** / **VULNERABILITY_ASSESSMENT_CHANGE_EVENT** track changes
4. Entity-level events track impact on specific infrastructure components

### Entity Connections

- **affected_entity.id** connects to Dynatrace entity model
- **related_entities.\*** arrays show infrastructure relationships
- **dt.entity.\*** fields provide direct entity references
- **management_zones.ids** show organizational groupings

### Time-based Analysis

- Use `timestamp` for event ordering
- Use `scan.time.completed` for scan timing
- Use `vulnerability.first_seen` for vulnerability lifecycle
- Use `finding.time.created` for compliance finding timing
