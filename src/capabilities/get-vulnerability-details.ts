import { _OAuthHttpClient } from '@dynatrace-sdk/http-client';
import { SecurityProblemsClient } from '@dynatrace-sdk/client-classic-environment-v2';

export const getVulnerabilityDetails = async (dtClient: _OAuthHttpClient, securityProblemId: string) => {
  const securityProblemsClient = new SecurityProblemsClient(dtClient);

  const response = await securityProblemsClient.getSecurityProblem({
    id: securityProblemId,
    fields:
      'riskAssessment,codeLevelVulnerabilityDetails,globalCounts,description,remediationDescription,exposedEntities,affectedEntities,relatedAttacks,entryPoints',
  });

  return response;
};
