{"version":15,"variables":[{"key":"PIT_Selector","type":"csv","input":"0,5,10,15,20,25,30,35,40,45,50,55,60","multiple":false,"visible":true},{"key":"Severity","type":"query","input":"fetch events\n| filter event.kind == \"DAVIS_PROBLEM\" and event.status_transition == \"CLOSED\"\n| summarize collectDistinct(event.category)","multiple":false,"visible":true},{"key":"entity_tags","type":"query","visible":true,"input":"fetch dt.davis.problems\n| expand entity_tags\n| fields entity_tags\n| dedup entity_tags\n| append [data record(entity_tags=\"NONE\")]\n| limit 10000","multiple":true,"defaultValue":["NONE"]},{"key":"alerting_profile","type":"query","visible":true,"input":"fetch dt.davis.problems\n| expand labels.alerting_profile\n| fields labels.alerting_profile\n| append [data record(labels.alerting_profile=\"NONE\")]\n| dedup labels.alerting_profile\n| limit 100000","multiple":false,"defaultValue":"NONE"}],"tiles":{"0":{"type":"markdown","title":"","content":"----\n# Incident Summary Analysis \n----\n"},"1":{"type":"data","title":"MTTR (wo RCA)","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == $Severity and maintenance.is_under_maintenance==false\n| filter dt.davis.is_duplicate == false\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filterOut (isNotNull(root_cause_entity_id))\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| fieldsAdd resolutiontime=(toDuration(resolved_problem_duration))\n| summarize close_rs=max(closed_prb),\n            resolutionTime=median(resolutiontime),\n            by:{event.name}\n| fieldsKeep resolutionTime, event.name","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxisTickLayout":"horizontal","layout":"vertical","categoryAxis":"event.name","categoryAxisLabel":"event.name","valueAxis":"resolutionTime","valueAxisLabel":"resolutionTime"},"legend":{"position":"auto","hidden":false},"colorPalette":"fireplace"},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"event.name"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{"category":"event.name","value":"event.name"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"resolutionTime","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"2":{"type":"data","title":"MTTR (with RCA)","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == $Severity and maintenance.is_under_maintenance==false\n| filter not(dt.davis.is_duplicate)\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| fieldsAdd closed_prb = if(event.status == \"CLOSED\" AND (event.status_transition == \"CLOSED\"),timestamp)\n| filter isNotNull(closed_prb)\n| filterOut isNull(root_cause_entity_id)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| fieldsAdd resolutiontime=(toDuration(resolved_problem_duration))\n| summarize close_rs=max(closed_prb),\n            resolutionTime=median(resolutiontime),\n            by:{event.name}\n| sort resolutionTime, direction:\"descending\"\n| fieldsKeep resolutionTime, event.name","visualization":"categoricalBarChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"swamps","categoricalBarChartSettings":{"categoryAxis":"event.name","categoryAxisLabel":"event.name","valueAxis":"resolutionTime","valueAxisLabel":"resolutionTime"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"event.name"},"table":{"rowDensity":"condensed","enableLineWrap":false,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{"category":"event.name","value":"event.name"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"resolutionTime","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"4":{"type":"data","title":"Incidents","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and  event.category == $Severity\n| filter not(dt.davis.is_duplicate) and maintenance.is_under_maintenance == false\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filterOut isNull(root_cause_entity_id)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize Incidents = countDistinct(display_id), by:{display_id}\n| summarize count()","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"recordField":"count()"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"6":{"type":"data","title":"Incidents wo Maintenance window","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == \"AVAILABILITY\" \n| filter dt.davis.is_duplicate == false\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filter isNull(root_cause_entity_id)\n| filter maintenance.is_under_maintenance==false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize count()","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"recordField":"count()"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"7":{"type":"data","title":"Incidents","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == $Severity and maintenance.is_under_maintenance==false\n| filter not(dt.davis.is_duplicate)\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filterOut isNotNull(root_cause_entity_id)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize Incidents = countDistinct(display_id), by:{display_id}\n| summarize count()","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"recordField":"count()"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"8":{"type":"data","title":"Incidents (with RCA)","query":"fetch dt.davis.problems\n| filter not(dt.davis.is_duplicate)\n| filter event.kind == \"DAVIS_PROBLEM\" and toLong(resolved_problem_duration)>=(toLong($PIT_Selector) * 60000000000) and event.category == $Severity and maintenance.is_under_maintenance==false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filterOut (isNull(root_cause_entity_id))\n| summarize Incidents = countDistinct(display_id), by:{event.name}\n| sort Incidents, direction:\"descending\"\n| fieldsRename event.name, ProblemTitle","visualization":"donutChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"apdex","categoricalBarChartSettings":{"categoryAxis":"ProblemTitle","categoryAxisLabel":"ProblemTitle","valueAxis":"Incidents","valueAxisLabel":"Incidents"},"circleChartSettings":{"showTotalValue":true}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"ProblemTitle"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["affected_entity_ids"]]},"honeycomb":{"shape":"square","dataMappings":{"category":"ProblemTitle","value":"Incidents"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"Incidents","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"9":{"type":"data","title":"Incidents (wo RCA)","query":"fetch dt.davis.problems\n| filter not(dt.davis.is_duplicate)\n| filter event.kind == \"DAVIS_PROBLEM\" and toLong(resolved_problem_duration)>=(toLong($PIT_Selector) * 60000000000) and event.category == $Severity and maintenance.is_under_maintenance==false\n| filterOut isNotNull(root_cause_entity_id)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| dedup display_id\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| summarize Incidents = countDistinct(display_id), by:{event.name}\n| sort Incidents, direction:\"descending\"\n| fieldsRename event.name, ProblemTitle","visualization":"donutChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","colorPalette":"fireplace","categoricalBarChartSettings":{"categoryAxis":"ProblemTitle","categoryAxisLabel":"ProblemTitle","valueAxis":"Incidents","valueAxisLabel":"Incidents"},"circleChartSettings":{"showTotalValue":true}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"ProblemTitle"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{"category":"ProblemTitle","value":"Incidents"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"Incidents","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"10":{"type":"data","title":"Host graceful shutdown wo maintainence window","query":"fetch dt.davis.problems\n| filter event.kind == \"DAVIS_EVENT\"\n| filter dt.davis.is_duplicate == false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filter event.type == \"OSI_GRACEFULLY_SHUTDOWN\" and maintenance.is_under_maintenance==false\n| summarize count()","visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"recordField":"count()"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"37":{"type":"data","title":"MTTR (mins)","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == $Severity and maintenance.is_under_maintenance==false\n| filter not(dt.davis.is_duplicate)\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filterOut isNull(root_cause_entity_id)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize Incidents = countDistinct(display_id), by:{display_id, resolved_problem_duration}\n| summarize close_rs=median(toLong(resolved_problem_duration)/60000000000)\n","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"mins","autoscale":false,"recordField":"close_rs"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"close_rs","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"38":{"type":"data","title":"Total Incidents","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\" and event.category == $Severity and maintenance.is_under_maintenance==false\n| filter not(dt.davis.is_duplicate)\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize Incidents = countDistinct(display_id), by:{display_id}\n| summarize Incidents=count()","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","autoscale":false,"recordField":"Incidents"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["affected_entity_ids"]]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"Incidents","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"39":{"type":"data","title":"MTTR (mins)","query":"fetch dt.davis.problems\n| filter event.kind==\"DAVIS_PROBLEM\" and event.status==\"CLOSED\"  \n| filter Not(dt.davis.is_duplicate)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filter event.category == $Severity and maintenance.is_under_maintenance==false\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| filterOut isNotNull(root_cause_entity_id)\n| summarize Incidents = countDistinct(display_id), by:{display_id, resolved_problem_duration}\n| summarize close_rs=median(toLong(resolved_problem_duration)/60000000000)\n","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"mins","autoscale":false,"recordField":"close_rs"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{}},"histogram":{"dataMappings":[{"valueAxis":"close_rs","rangeAxis":""}]}},"visualization":"singleValue","querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"40":{"type":"markdown","title":"","content":"\n>### Incident additional insights\n>---"},"41":{"type":"data","title":"Top Incident-Generating Host Entities or Incident-Causing Hosts","query":"fetch dt.davis.problems\n| filter event.kind == \"DAVIS_PROBLEM\" and event.category == $Severity and event.status_transition == \"CLOSED\" and maintenance.is_under_maintenance == false\n| filter dt.davis.is_duplicate == false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| summarize cnt= countDistinct(display_id),  by:{root_cause_entity_id, event.name}\n| filter contains(root_cause_entity_id, \"HOST\")\n|lookup [fetch dt.entity.host], lookupField:id, sourceField:root_cause_entity_id\n| limit 5\n|fieldsAdd lookup.tags\n| fieldsKeep  cnt, root_cause_entity_id, lookup.entity.name,lookup.tags, event.name\n| sort cnt desc\n| fieldsRename cnt, Incidents, root_cause_entity_id, HostCausingIncidentUUID, lookup.entity.name, HostCausingIncident, lookup.tags, HostCausingIncidentTags, event.name, ProblemTitle\n| fields Incidents, ProblemTitle, HostCausingIncident,HostCausingIncidentTags, HostCausingIncidentUUID","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxisLabel":"ProblemTitle","valueAxisLabel":"Incidents"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Incidents"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["HostCausingIncidentTags"]]},"honeycomb":{"shape":"square","dataMappings":{},"legend":"auto"},"histogram":{"dataMappings":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"42":{"type":"data","title":"Top Incident-Generating Processes or Incident-Causing Processes","query":"fetch dt.davis.problems\n| filter event.kind == \"DAVIS_PROBLEM\" and event.category == $Severity and event.status_transition == \"CLOSED\" and maintenance.is_under_maintenance == false\n| filter dt.davis.is_duplicate == false\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| summarize cnt= countDistinct(display_id),  by:{root_cause_entity_id, event.name}\n| filter contains(root_cause_entity_id, \"PROCESS\")\n|lookup [fetch dt.entity.process_group], lookupField:id, sourceField:root_cause_entity_id\n| limit 5\n|fieldsAdd lookup.tags\n| fieldsKeep  cnt, root_cause_entity_id, lookup.entity.name,lookup.tags, event.name\n| sort cnt desc\n| fieldsRename cnt, Incidents, root_cause_entity_id, PGCausingIncidentUUID,lookup.entity.name, PGCausingIncident, lookup.tags, PGCausingIncidentTags, event.name, ProblemTitle\n| fields Incidents, ProblemTitle, PGCausingIncident, PGCausingIncidentTags, PGCausingIncidentUUID","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxisLabel":"ProblemTitle","valueAxisLabel":"Incidents","categoryAxis":"ProblemTitle","valueAxis":"Incidents"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Incidents"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["PGCausingIncidentTags"]]},"honeycomb":{"shape":"square","dataMappings":{"category":"ProblemTitle","value":"Incidents"},"legend":"auto"},"histogram":{"dataMappings":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"43":{"type":"data","title":"Top Incident-Generating Services or Incident-Causing Services","query":"fetch dt.davis.problems\n| filter event.kind == \"DAVIS_PROBLEM\" and event.category == $Severity and event.status_transition == \"CLOSED\" and maintenance.is_under_maintenance == false\n| filter dt.davis.is_duplicate == false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| summarize cnt= countDistinct(display_id),  by:{root_cause_entity_id, event.name}\n| filter contains(root_cause_entity_id, \"SERVICE\")\n|lookup [fetch dt.entity.service], lookupField:id, sourceField:root_cause_entity_id\n|fieldsAdd lookup.tags\n| fieldsKeep  cnt, root_cause_entity_id, lookup.entity.name,lookup.tags, event.name\n| sort cnt desc\n| fieldsRename cnt, Incidents, root_cause_entity_id, SVCCausingIncidentUUID, lookup.entity.name, SVCCausingIncident, lookup.tags, SVCCausingIncidentTags, event.name, ProblemTitle\n| fields Incidents, ProblemTitle, SVCCausingIncident, SVCCausingIncidentTags, SVCCausingIncidentUUID","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxis":"ProblemTitle","categoryAxisLabel":"ProblemTitle","valueAxis":"Incidents","valueAxisLabel":"Incidents"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Incidents"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[["SVCCausingIncidentTags"]]},"honeycomb":{"shape":"square","dataMappings":{"category":"ProblemTitle","value":"Incidents"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"Incidents","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"45":{"type":"data","title":"Top Incident-Generating Application or Incident-Causing Applications","query":"fetch dt.davis.problems\n| filter event.kind == \"DAVIS_PROBLEM\" and event.category == $Severity and event.status_transition == \"CLOSED\" and maintenance.is_under_maintenance == false\n| filter dt.davis.is_duplicate == false\n| fieldsAdd entity_tags = if(isNull(entity_tags), \"NA\", else:entity_tags)\n| expand entityId = affected_entity_ids\n| expand tags=entity_tags\n| expand alerting_profile=labels.alerting_profile\n| filter in($entity_tags, \"NONE\") OR in(tags,$entity_tags)\n| filter in($alerting_profile, \"NONE\") OR in(alerting_profile,$alerting_profile)\n| dedup display_id\n| filter toLong(resolved_problem_duration) >= (toLong($PIT_Selector)*60000000000)\n| summarize cnt= countDistinct(display_id),  by:{root_cause_entity_id, event.name}\n| filter contains(root_cause_entity_id, \"APPLICATION\")\n|lookup [fetch dt.entity.application], lookupField:id, sourceField:root_cause_entity_id\n|fieldsAdd lookup.tags\n| fieldsKeep  cnt, root_cause_entity_id, lookup.entity.name,lookup.tags, event.name\n| sort cnt desc\n| fieldsRename cnt, Occurences, root_cause_entity_id, AppCausingIncidentUUID,lookup.entity.name, AppCausingIncident, lookup.tags, AppCausingIncidentTags, event.name, ProblemTitle\n| fields Occurences, ProblemTitle, AppCausingIncidentUUID, AppCausingIncident, AppCausingIncidentTags","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxisLabel":"ProblemTitle","valueAxisLabel":"Occurences","categoryAxis":"ProblemTitle","valueAxis":"Occurences"}},"singleValue":{"showLabel":true,"label":"","autoscale":true,"recordField":"Occurences"},"table":{"enableLineWrap":true,"hiddenColumns":[],"lineWrapIds":[]},"honeycomb":{"shape":"square","dataMappings":{"category":"ProblemTitle","value":"Occurences"},"legend":"auto"},"histogram":{"dataMappings":[{"valueAxis":"Occurences","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"46":{"type":"markdown","title":"","content":"\n>### Incident-causing insights\n>---"},"47":{"type":"markdown","title":"","content":"### If there are any graceful shutdowns, it is recommended to have a maintenance window setup!!"},"48":{"type":"markdown","title":"","content":"##### 🔘 Selected entity_tags Zone:&nbsp;&nbsp;&nbsp;&nbsp;  $entity_tags \n##### 🔘 Severity:&nbsp;&nbsp;&nbsp;&nbsp; $Severity\n##### 🔘 Time Setting for Problem to Incident: &nbsp;&nbsp;&nbsp;&nbsp;$PIT_Selector mins"},"49":{"type":"markdown","title":"","content":"\\\n<br>\n> ### Incident summary with DAVIS AI (RCA)\n>---"},"50":{"type":"markdown","title":"","content":"\\\n<br>\n>### Incident summary without DAVIS AI (No RCA) \n>---"}},"layouts":{"0":{"x":0,"y":0,"w":24,"h":2},"1":{"x":13,"y":17,"w":11,"h":6},"2":{"x":1,"y":17,"w":11,"h":6},"4":{"x":1,"y":8,"w":5,"h":3},"6":{"x":1,"y":25,"w":6,"h":3},"7":{"x":13,"y":8,"w":5,"h":3},"8":{"x":1,"y":11,"w":11,"h":6},"9":{"x":13,"y":11,"w":11,"h":6},"10":{"x":7,"y":25,"w":6,"h":3},"37":{"x":6,"y":8,"w":6,"h":3},"38":{"x":13,"y":2,"w":11,"h":4},"39":{"x":18,"y":8,"w":6,"h":3},"40":{"x":0,"y":23,"w":24,"h":2},"41":{"x":1,"y":30,"w":12,"h":4},"42":{"x":13,"y":30,"w":11,"h":4},"43":{"x":1,"y":34,"w":12,"h":5},"45":{"x":13,"y":34,"w":11,"h":5},"46":{"x":0,"y":28,"w":24,"h":2},"47":{"x":14,"y":25,"w":10,"h":3},"48":{"x":1,"y":2,"w":11,"h":4},"49":{"x":0,"y":6,"w":12,"h":2},"50":{"x":12,"y":6,"w":12,"h":2}},"importedWithCode":false}