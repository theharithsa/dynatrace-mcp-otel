{"version":18,"variables":[{"key":"tenant","type":"query","visible":false,"input":"fetch dt.entity.environment\n| fields dt.system.environment","multiple":false,"version":1},{"key":"Process_Group","type":"query","visible":true,"input":"fetch dt.entity.process_group\n| fields entity.name\n| dedup entity.name","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"],"version":1},{"key":"Tag","visible":true,"type":"query","version":1,"editable":true,"input":"// fetch dt.entity.process_group\n// | filter in(entity.name, $Process_Group)\n// | fieldsAdd tags\n// | expand tags\n// | parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n// | fields tagkey = replaceString(tag, \"\\\\\", \"\\\\\\\\\")\n// | fieldsAdd tagkey = if(isNull(tagkey), \"No_Tag\", else:tagkey)\n// | sort tagkey asc\n// | dedup tagkey\n\n\nfetch dt.entity.process_group\n| filter in(entity.name, $Process_Group)\n| fieldsAdd tags\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fields tagkey = replaceString(tag, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tagkey), \"No_Tag\", else:tagkey)\n| append [\n    fetch dt.entity.process_group_instance\n    | fieldsAdd softwareTechnologies,tags,instance_of\n    | expand dt.entity.process_group = instance_of[dt.entity.process_group]\n    //| filter in(dt.entity.process_group, $Process_Group)\n    | expand tags\n    | parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n    | fieldsAdd tag = replaceString(tag, \"\\\\\", \"\\\\\\\\\")\n    | fieldsAdd tag = if(isNull(tag), \"No_Tag\", else:tag)\n    | fieldsRename tagkey = tag\n    | fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n  ]\n| fields tagkey\n| sort tagkey asc\n| dedup tagkey","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"]},{"key":"Value","type":"query","visible":true,"input":"// fetch dt.entity.process_group\n// | fieldsAdd tags\n// | expand tags\n// | parse tags, \"\"\"((LD:tagkey (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n// | fields tagkey, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n// | fieldsAdd tagkey = if(isNull(tagkey), \"No_Tag\", else:tagkey)\n// | fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n// | filter in(tagkey, {$Tag})\n// | dedup value\n// | fieldsRemove tagkey\n\nfetch dt.entity.process_group\n| fieldsAdd tags\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fields tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, {$Tag})\n| append [\n    fetch dt.entity.process_group_instance\n    | expand tags\n    | parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n    | fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n    | fieldsAdd tag = if(isNull(tag), \"No_Tag\", else:tag)\n    | fieldsRename tagkey = tag\n    | fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n    | filter in(tagkey, {$Tag})\n  ]\n| dedup value\n| fields value","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"],"version":1},{"key":"Technology","type":"query","visible":true,"input":"// fetch dt.entity.process_group\n// | fieldsAdd softwareTechnologies,tags\n// | filter in(entity.name, $Process_Group)\n// | expand tags\n// | parse tags, \"\"\"((LD:tagkey (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n// | fieldsAdd tagkey, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n// | fieldsAdd tagkey = if(isNull(tagkey), \"No_Tag\", else:tagkey)\n// | fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n// | filter in(tagkey, {$Tag})\n// | filter in(value, $Value)\n// | expand softwareTechnologies\n// | parse softwareTechnologies, \"\"\"'type:' LD:Technology ','\"\"\"\n// | fieldsAdd Technology = if(isNull(Technology), \"Other\", else: Technology)\n// | fields Technology\n// | dedup Technology\n\n\nfetch dt.entity.process_group\n| fieldsAdd softwareTechnologies,tags\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, {$Tag})\n| filter in(value, $Value)\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:Technology ','\"\"\"\n| fieldsAdd Technology = if(isNull(Technology), \"Other\", else: Technology)\n| append [\n    fetch dt.entity.process_group_instance\n    | expand softwareTechnologies\n    | parse softwareTechnologies, \"\"\"'type:' LD:Technology ','\"\"\"\n    | fieldsAdd Technology = if(isNull(Technology), \"Other\", else: Technology)\n  ]\n| fields Technology\n| dedup Technology","multiple":true,"defaultValue":["3420b2ac-f1cf-4b24-b62d-61ba1ba8ed05*"],"version":1}],"tiles":{"0":{"title":"Technology Breakdown by version","type":"data","query":"fetch dt.entity.process_group\n| fieldsAdd id,icon,softwareTechnologies,tags,dt.security_context\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, {$Tag})\n| filter in(value, $Value)\n| fieldsAdd icon = icon[primaryIconType]\n//| filter icon != \"dynatrace\"\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:Technology ',edition:' LD:Edition ',version:' LD:Version\"\"\"\n| fieldsAdd Technology = if(isNull(Technology), \"Other\", else: Technology)\n| filter in(Technology, $Technology)\n| summarize Total_PGs = countDistinct(id), by:{Technology, Edition, Version}\n| sort Total_PGs desc\n","visualization":"table","visualizationSettings":{"thresholds":[{"id":1,"field":"Total_PGs","title":"","isEnabled":true,"rules":[{"id":0,"color":"#CAE7E8","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#A8D8DF","comparator":"â‰¥","label":"","value":15},{"id":2,"color":"#86C9D6","comparator":"â‰¥","label":"","value":25},{"id":3,"color":"#64B9CC","comparator":"â‰¥","label":"","value":35},{"id":4,"color":"#42AAC3","comparator":"â‰¥","label":"","value":45},{"id":5,"color":"#209BBA","comparator":"â‰¥","label":"","value":100},{"id":6,"color":{"Default":"var(--dt-colors-charts-categorical-color-07-default, #438fb1)"},"comparator":"â‰¥","label":"","value":200}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"absolute","groupingThresholdValue":10,"valueType":"relative","showTotalValue":false},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"relative","groupMode":"grouped","colorPaletteMode":"multi-color","categoryAxisLabel":"Technology,Edition,Version","valueAxisLabel":"Total_PGs","tooltipVariant":"single","isCategoryLabelVisible":true},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"entity.name","prefixIcon":"","recordField":"entity.name","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"Version\"]":125.234375,"[\"Edition\"]":171.34375,"[\"Technology\"]":204.453125},"columnTypeOverrides":[{"id":8357301.100000001,"fields":["Total_PGs"],"value":"meterbar"}],"sortBy":{"columnId":"[\"Total_PGs\"]","direction":"descending"},"colorThresholdTarget":"value","enableThresholdInRow":false},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"dataMappings":{"value":"Total_PGs"},"displayedFields":["Technology","Edition","Version"],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total_PGs","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["Technology","Edition","Version"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"dataMapping":{"value":"Total_PGs"},"recordView":{"fieldsWidth":216.51},"colorModeType":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"1":{"title":"Top Technologies by version, # of process_groups","type":"data","query":"fetch dt.entity.process_group\n| fieldsAdd id,icon,softwareTechnologies,tags,dt.security_context\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, $Tag)\n| filter in(value, $Value)\n| fieldsAdd icon = icon[primaryIconType]\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:Technology ',edition:' LD:Edition ',version:' LD:Version\"\"\"\n| fieldsAdd Technology = if(isNull(Technology), \"Other\", else: Technology)\n| filter in(Technology, $Technology)\n| summarize Total_PGs = countDistinct(id), by:{Technology, Version}\n| sort Total_PGs desc","visualization":"donutChart","visualizationSettings":{"thresholds":[{"id":1,"field":"Total_PGs","title":"","isEnabled":true,"rules":[{"id":0,"color":"#CAE7E8","comparator":"â‰¥","label":"","value":0},{"id":1,"color":"#A8D8DF","comparator":"â‰¥","label":"","value":15},{"id":2,"color":"#86C9D6","comparator":"â‰¥","label":"","value":25},{"id":3,"color":"#64B9CC","comparator":"â‰¥","label":"","value":35},{"id":4,"color":"#42AAC3","comparator":"â‰¥","label":"","value":45},{"id":5,"color":"#209BBA","comparator":"â‰¥","label":"","value":100},{"id":6,"color":{"Default":"var(--dt-colors-charts-categorical-color-07-default, #438fb1)"},"comparator":"â‰¥","label":"","value":200}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"number-of-slices","groupingThresholdValue":12,"valueType":"relative","showTotalValue":false,"groupingName":"Technologies Combined","hideLabels":false},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"relative","groupMode":"grouped","colorPaletteMode":"multi-color","categoryAxis":["Technology","Version"],"categoryAxisLabel":"Technology,Version","valueAxis":["Total_PGs"],"valueAxisLabel":"Total_PGs","tooltipVariant":"single","isCategoryLabelVisible":true},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"end","legend":{"position":"right","hidden":false}},"singleValue":{"showLabel":true,"label":"entity.name","prefixIcon":"","recordField":"entity.name","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"Version\"]":125.234375,"[\"Edition\"]":171.34375,"[\"Technology\"]":204.453125},"columnTypeOverrides":[{"id":8357301.100000001,"fields":[],"value":"meterbar"}],"sortBy":{"columnId":"[\"Total_PGs\"]","direction":"descending"},"colorThresholdTarget":"value","enableThresholdInRow":false},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"dataMappings":{"value":"Total_PGs"},"displayedFields":["Technology","Version"],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Total_PGs","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["Technology","Version"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"dataMapping":{"value":"Total_PGs"},"recordView":{"fieldsWidth":216.51},"colorModeType":{}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"3":{"title":"Technology Breakdown & Security Vulnerabilities by dt.process_group","type":"data","query":"fetch dt.entity.process_group\n| fieldsAdd id,entity.name, icon,softwareTechnologies,runs_on,tags\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, {$Tag})\n| filter in(value, $Value)\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:technology ',edition:' LD:edition ',version:' LD:version\"\"\"\n| fieldsAdd dt.entity.host = runs_on[dt.entity.host], technology = if(isNull(technology), \"Other\", else: technology)\n| filter in(technology, $Technology)\n| expand runs_on[dt.entity.host]\n| join [\n    fetch events\n    | filter dt.system.bucket==\"default_security_events\"\n    | filter event.provider==\"Dynatrace\"\n    | filter event.level==\"ENTITY\"\n    | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n    | fields pg.id = dt.entity.process_group, pg.name = affected_entity.name, vulnerability.status = event.status, vulnerability.technology\n    | dedup pg.id\n  ],\n  kind: leftOuter,\n  on: { left[id] == right[pg.id] }\n| fieldsadd details = concat(\"[](https://\", $tenant, \".apps.dynatrace.com/ui/apps/dynatrace.classic.vulnerabilities/ui/security/vulnerabilities?filters=affectedPgIds%3A\", id, \")\")\n| fieldsAdd cd = concat(\"True ðŸ’£\", details)\n| fieldsAdd vulnerable = if(isNull(right.pg.id), \"False\", else: \"True\")\n| fieldsAdd `ðŸ”¹` = if(vulnerable == \"True\", \"ðŸ’€\", else: \"ðŸ›¡ï¸\" )\n| fieldsAdd isVulnerable = if(vulnerable == \"True\", cd, else: \"False\" )\n| fieldsRename vulnerability.status = right.vulnerability.status\n| fieldsAdd dt.entity.process_group = concat(\"[\", entity.name ,\"](https://\", $tenant, \".apps.dynatrace.com/ui/apps/dynatrace.classic.technologies/#processgroupdetails;id=\", id, \")\")\n| fields `ðŸ”¹`, dt.entity.process_group, dt.entity.host, technology, edition, version, isVulnerable, vulnerability.status\n","visualization":"table","visualizationSettings":{"thresholds":[{"id":2,"field":"vulnerability.status","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-07-default, #438fb1)"},"comparator":"=","label":"","value":"RESOLVED"},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"!=","label":"","value":"RESOLVED"}]},{"id":3,"field":"ðŸ”¹","title":"","isEnabled":true,"rules":[{"id":2,"color":"#2C2F3F","comparator":"=","label":"","value":"ðŸ’€"},{"id":3,"color":"#2C2F3F","comparator":"=","label":"","value":"ðŸ›¡ï¸"}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"absolute","groupingThresholdValue":10,"valueType":"relative","showTotalValue":false},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"relative","groupMode":"grouped","colorPaletteMode":"multi-color","categoryAxis":["ðŸ”¹","dt.entity.process_group","dt.entity.host","technology","edition","version","isVulnerable","vulnerability.status"],"categoryAxisLabel":"ðŸ”¹,dt.entity.process_group,dt.entity.host,technology,edition,version,isVulnerable,vulnerability.status","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single","isCategoryLabelVisible":true},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"entity.name","prefixIcon":"","recordField":"entity.name","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","sparklineSettings":{}},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"Version\"]":125.234375,"[\"Edition\"]":171.34375,"[\"Technology\"]":204.453125,"[\"entity.name\"]":471,"[\"ðŸ”¹\"]":37.234375,"[\"dt.entity.host\"]":443,"[\"version\"]":183.6875},"columnTypeOverrides":[{"id":5333393.8999999985,"fields":["isVulnerable","dt.entity.process_group"],"value":"markdown"}],"sortBy":{"columnId":"[\"isVulnerable\"]","direction":"descending"},"colorThresholdTarget":"value","enableThresholdInRow":false,"selectedColumnForRowThreshold":"isVulnerable"},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"dataMappings":{"value":"ðŸ”¹"},"displayedFields":["ðŸ”¹","dt.entity.process_group","technology","edition","version","isVulnerable","vulnerability.status"],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle","displayedFields":["ðŸ”¹","dt.entity.process_group","technology","edition","version","isVulnerable"]},"valueBoundaries":{"min":"auto","max":"auto"},"label":{"showLabel":false,"label":"count"},"icon":{"showIcon":false,"icon":""},"autoSelectVisualization":false,"dataMapping":{"value":"Total_PGs"},"recordView":{"fieldsWidth":216.51},"colorModeType":{}},"querySettings":{"maxResultRecords":20000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":15,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"5":{"title":"Vulnerable Process_Groups","type":"data","query":"fetch dt.entity.process_group\n| fieldsAdd id,softwareTechnologies,runs_on,tags\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, $Tag)\n| filter in(value, $Value)\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:technology ',edition:' LD:edition ',version:' LD:version\"\"\"\n| fieldsAdd dt.entity.host = runs_on[dt.entity.host], technology = if(isNull(technology), \"Other\", else: technology)\n| filter in(technology, $Technology)\n| expand runs_on[dt.entity.host]\n| join [\n    fetch events\n    | filter dt.system.bucket==\"default_security_events\"\n    | filter event.provider==\"Dynatrace\"\n    | filter event.level==\"ENTITY\"\n    | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n    | fields pg.id = dt.entity.process_group, pg.name = affected_entity.name, vulnerability.status = event.status, vulnerability.technology\n    | dedup pg.id\n  ],\n  kind: leftOuter,\n  on: { left[id] == right[pg.id] }\n| fieldsAdd isVulnerable = if(isNull(right.pg.id), \"False\", else: \"True\")\n| fieldsRename dt.entity.process_group = entity.name, vulnerability.status = right.vulnerability.status\n| filter isVulnerable == \"True\"\n| summarize `Vulnerable Process_Groups` = countDistinct(id)","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"Vulnerable Process_Groups","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-status-ideal-default, #2f6863)"},"comparator":"=","label":"","value":0},{"id":2,"color":{"Default":"var(--dt-colors-charts-status-critical-default, #c4233b)"},"comparator":"â‰¥","label":"","value":1}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["Vulnerable Process_Groups"],"categoryAxisLabel":"Vulnerable Process_Groups","valueAxis":["Vulnerable Process_Groups"],"valueAxisLabel":"Vulnerable Process_Groups","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":false,"label":"Vulnerable Process_Groups","prefixIcon":"SecurityHighIcon","recordField":"Vulnerable Process_Groups","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":true},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"Vulnerable Process_Groups","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"count"},"label":{"showLabel":false,"label":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"6":{"title":"Total Vulnerabilities","type":"data","query":"fetch dt.entity.process_group\n| fieldsAdd id,icon,softwareTechnologies,runs_on,tags\n| filter in(entity.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, $Tag)\n| filter in(value, $Value)\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:technology ',edition:' LD:edition ',version:' LD:version\"\"\"\n| fieldsAdd dt.entity.host = runs_on[dt.entity.host], technology = if(isNull(technology), \"Other\", else: technology)\n| filter in(technology, $Technology)\n| expand runs_on[dt.entity.host]\n| join [\n    fetch events\n    | filter dt.system.bucket==\"default_security_events\"\n    | filter event.provider==\"Dynatrace\"\n    | filter event.level==\"ENTITY\"\n    | filter vulnerability.parent.mute.status == \"NOT_MUTED\"\n    | fields pg.id = dt.entity.process_group, pg.name = affected_entity.name, v.id = vulnerability.id, vulnerability.status = event.status, vulnerability.technology\n  ],\n  kind: leftOuter,\n  on: { left[id] == right[pg.id] }\n| summarize count = countDistinct(right.v.id)","visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"count","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-status-ideal-default, #2f6863)"},"comparator":"=","label":"","value":0},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"â‰¥","label":"","value":1}]}],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["count"],"categoryAxisLabel":"count","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":false,"label":"Vulnerable Process_Groups","prefixIcon":"VulnerableFunctionIcon","recordField":"count","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value","isIconVisible":true},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{"value":"count"},"label":{"showLabel":false,"label":"count"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"7":{"type":"markdown","content":"# Technology Version & Vulnerability Tracker ðŸ›¡ï¸ðŸŽ¯\n\nA sample dashboard to track your technology footprint across the enterprise.\n\nVersion: 1.1\n \n---\n###### Use the Tag Filters to track your application, web, db, etc. processes by \n`Application`/`Team`/`Org`/`Business Unit`/`Project`/`Deployment`/`Cost Center`/`K8s_Namespaces`, or anything else that you need!\n\n> Use the `isVulnerable` drilldown link to get full details of the impacted process [vulnerabilities](/ui/apps/dynatrace.security.vulnerabilities/vulnerabilities)  and mitigation recommendations.\n"},"8":{"title":"Process Group Instances","type":"data","query":"fetch dt.entity.process_group_instance\n| fieldsAdd softwareTechnologies,tags,instance_of,metadata\n| fieldsAdd dt.entity.process_group = instance_of[dt.entity.process_group]\n| fieldsAdd pg.name = entityName(dt.entity.process_group)\n| filter in(pg.name, $Process_Group)\n| expand tags\n| parse tags, \"\"\"((LD:tag (!<<'\\\\' ':') LD:value)|LD:tag)\"\"\"\n| fieldsAdd tag, value = replaceString(value, \"\\\\\", \"\\\\\\\\\")\n| fieldsAdd tagkey = if(isNull(tag), \"No_Tag\", else:tag)\n| fieldsAdd value = if(isNull(value), \"No_Value\", else:value)\n| filter in(tagkey, $Tag)\n| filter in(value, $Value)\n| expand softwareTechnologies\n| parse softwareTechnologies, \"\"\"'type:' LD:technology ',edition:' LD:edition ',version:' LD:version\"\"\"\n| fieldsAdd technology = if(isNull(technology), \"Other\", else: technology)\n| filter in(technology, $Technology)\n// | fieldsAdd process_instance = concat(\"[\", entity.name, \"](https://\", $tenant, \".apps.dynatrace.com/ui/intent#%7B%22entityId%22%3A%22\", dt.entity.process_group, \"%22%7D)\")\n// | fieldsAdd process_group = concat(\"[\", pg.name, \"](https://\", $tenant, \".apps.dynatrace.com/ui/intent#%7B%22entityId%22%3A%22\", id, \"%22%7D)\")\n| fieldsAdd process_group = concat(\"[\", pg.name ,\"](https://\", $tenant, \".apps.dynatrace.com/ui/apps/dynatrace.classic.technologies/#processgroupdetails;id=\", dt.entity.process_group, \")\")\n| fields id, entity.name, process_group, technology, edition, version,metadata","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxisLabel":"id,entity.name,process_group,technology,edition,version,metadata","valueAxisLabel":"","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"error","prefixIcon":"","recordField":"error","autoscale":true,"sparklineSettings":{},"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["metadata"]],"monospacedFontEnabled":true,"monospacedFontColumns":[["metadata"]],"columnWidths":{"[\"entity.name\"]":258.203125},"columnTypeOverrides":[{"id":19592410.8,"fields":["process_instance","process_group"],"value":"markdown"}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{"value":"id"},"displayedFields":["id","entity.name","process_group","technology","edition","version"],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle","displayedFields":["id","entity.name","process_group","technology","edition","version"]},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":false,"dataMapping":{},"label":{"showLabel":false}},"querySettings":{"maxResultRecords":20000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":20,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}}},"layouts":{"0":{"x":12,"y":5,"w":12,"h":6},"1":{"x":3,"y":5,"w":9,"h":6},"3":{"x":0,"y":11,"w":24,"h":7},"5":{"x":0,"y":5,"w":3,"h":3},"6":{"x":0,"y":8,"w":3,"h":3},"7":{"x":0,"y":0,"w":24,"h":5},"8":{"x":0,"y":18,"w":24,"h":6}},"importedWithCode":false,"settings":{}}